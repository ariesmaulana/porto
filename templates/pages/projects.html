{% extends 'layouts/base.html' %}

{% block title %}Portfolio | Projects{% endblock %}

{% block content %}
<div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-12 md:py-20">
    <!-- Header -->
    <div class="mb-16">
        <h1 class="text-6xl md:text-8xl font-black tracking-tighter mb-8">
            ALL<br />
            <span
                class="text-transparent bg-clip-text bg-gradient-to-r from-warm-accent to-warm-pop stroke-warm-text"
                style="-webkit-text-stroke: 3px #291c14"
                >PROJECTS</span
            >
        </h1>

        <!-- Filters -->
        <div
            class="flex flex-wrap gap-4 border-t-3 border-b-3 border-warm-text py-6 bg-warm-surface -mx-4 px-4 md:mx-0 md:px-0 md:bg-transparent md:border-t-0 md:border-b-0"
        >
            <a
                href="?category=all"
                class="px-6 py-2 font-mono font-bold border-2 border-warm-text transition-all uppercase text-sm md:text-base {% if current_filter == 'all' %}bg-warm-text text-warm-bg shadow-brutal{% else %}bg-transparent text-warm-text hover:bg-warm-pop shadow-brutal-sm{% endif %}"
                >All Work</a
            >

            {% for key, value in categories.items %}

            <a
                href="?category={{ key }}"
                class="px-6 py-2 font-mono font-bold border-2 border-warm-text transition-all uppercase text-sm md:text-base {% if current_filter == key %}bg-warm-text text-warm-bg shadow-brutal{% else %}bg-transparent text-warm-text hover:bg-warm-pop shadow-brutal-sm{% endif %}"
            >
                {{ value }}</a
            >
            {% endfor %}
        </div>
    </div>

    <!-- Grid -->
    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
        {% for project in projects %}
        <a
            href="{% url 'project_detail' project.id %}"
            class="block group relative h-full"
        >
            <article class="h-full">
                <div
                    class="absolute inset-0 bg-warm-text translate-x-3 translate-y-3 border-3 border-warm-text"
                ></div>
                <div
                    class="relative border-3 border-warm-text bg-warm-bg p-5 group-hover:-translate-x-1 group-hover:-translate-y-1 transition-transform duration-200 h-full flex flex-col"
                >
                    <!-- Image Placeholder -->
                    <div
                        class="aspect-square bg-warm-surface border-3 border-warm-text mb-5 overflow-hidden relative"
                    >
                        {% if project.image %}
                        <img src="{{ project.image.url }}" alt="{{ project.title }}" class="w-full h-full object-contain">
                        {% else %}
                        <div
                            class="absolute inset-0 flex items-center justify-center bg-warm-accent/10 group-hover:bg-warm-accent/20 transition-colors"
                        >
                            <span
                                class="font-mono text-3xl font-bold opacity-50"
                                >PROJECT_{{ project.id|stringformat:"02d"
                                }}</span
                            >
                        </div>
                        {% endif %}
                        <div
                            class="absolute top-0 right-0 w-8 h-8 bg-warm-pop border-l-3 border-b-3 border-warm-text"
                        ></div>
                    </div>

                    <div class="flex justify-between items-start mb-2">
                        <h3
                            class="text-xl font-black uppercase group-hover:text-warm-accent transition-colors leading-tight"
                        >
                            {{ project.title }}
                        </h3>
                    </div>

                    <div
                        class="flex justify-between items-center mb-4 border-b-2 border-warm-text/20 pb-2"
                    >
                        <span
                            class="font-mono text-xs font-bold uppercase text-warm-accent"
                            >{{ project.get_category_display }}</span
                        >
                        <span
                            class="font-mono text-xs border-2 border-warm-text px-2 py-0.5 rounded-full"
                            >{{ project.year }}</span
                        >
                    </div>

                    <p class="font-mono text-xs mb-6 flex-grow leading-relaxed">
                        {{ project.short_summary }}
                    </p>

                    <div class="flex gap-2 flex-wrap mt-auto">
                        {% for tag in project.tags %}
                        <span
                            class="text-[10px] font-bold bg-warm-surface px-2 py-1 border-2 border-warm-text"
                            >{{ tag }}</span
                        >
                        {% endfor %}
                    </div>
                </div>
            </article>
        </a>
        {% endfor %}
    </div>

    <!-- Empty State -->
    {% if not projects %}
    <div
        class="text-center py-20 border-3 border-dashed border-warm-text bg-warm-surface/50"
    >
        <p class="font-mono text-xl font-bold">
            NO PROJECTS FOUND IN THIS CATEGORY.
        </p>
        <a
            href="?category=all"
            class="inline-block mt-4 text-warm-accent underline font-bold hover:text-warm-text"
            >RESET FILTERS</a
        >
    </div>
    {% endif %}
</div>
{% endblock %}
